function asyncGeneratorStep(e,r,t,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,a)}function _asyncToGenerator(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function i(e){asyncGeneratorStep(o,n,a,i,c,"next",e)}function c(e){asyncGeneratorStep(o,n,a,i,c,"throw",e)}i(void 0)}))}}define(["jquery","i18n","lodash","clitpl","api","api!core.getAppCfg","checkperm","admin/task_create","moment","bootstrap-dialog","ApiError","dateDiff","admin/calendar/handlers/promotion","admin/calendar/handlers/rates","jquery-block"],(function(e,r,t,n,a,o,i,c,s,u,d,p,l,f){return function(m){var _=m._apartment,v=void 0===_?null:_,b=m.$calendar,k=m.fullcalendar,h=s.utc(Date.nowUTC()).startOf("day"),w=!1,x=!1;function g(e){return y.apply(this,arguments)}function y(){return(y=_asyncToGenerator(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.call("promotion._checkPromotionForSave",{_idowner:r._id,_dtfrom:w,_dtto:x}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return E.apply(this,arguments)}function E(){return(E=_asyncToGenerator(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i(["apartment.sellprice.edit"])){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,b.block(),e.next=6,f({apartment:r,_dtfrom:s.utc(w).startOf("day").hours(12).toDate(),_dtto:s.utc(x).startOf("day").hours(12).toDate()});case 6:e.sent.on("frm-saved",(function(e){k.refetchEvents()})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),window.appError(e.t0);case 13:return e.prev=13,b.unblock(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})))).apply(this,arguments)}function P(e,r){return T.apply(this,arguments)}function T(){return(T=_asyncToGenerator(regeneratorRuntime.mark((function r(t,n){var a,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i(["promotion.view"])){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,b.block(),r.next=6,l({_id:t,apartment:n,_dtfrom:w,_dtto:x});case 6:a=r.sent,o=e(a).modal(),window.setFullscreenModal(o),o.on("frm-saved",(function(e,r){o.modal("hide"),k.refetchEvents()})),o.on("frm-cancel",(function(){o.modal("hide")})),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(2),window.appError(r.t0);case 16:return r.prev=16,b.unblock(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[2,13,16,19]])})))).apply(this,arguments)}function G(e){return D.apply(this,arguments)}function D(){return(D=_asyncToGenerator(regeneratorRuntime.mark((function r(t){var a,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i(["promotion.edit"])){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,b.block(),r.next=6,n._render("calendar/promotion_simple",{_dtfrom:w,_dtto:x,_idapartment:t._id,_idregion:t._idregion,week:[1,2,3,4,5,6,0].map((function(e){return{day:e,text:s.utc().day(e).format("ddd").toUpperCase()}}))});case 6:a=r.sent,(o=e(a).modal()).on("frm-saved",(function(){o.modal("hide"),k.refetchEvents()})),o.on("frm-cancel",(function(){o.modal("hide")})),window.setFullscreenModal(o),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(2),window.appError(r.t0);case 16:return r.prev=16,b.unblock(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[2,13,16,19]])})))).apply(this,arguments)}function M(e,t){return u.confirm({title:r("Warning!"),type:u.TYPE_WARNING,message:r("This action cannot be withdrawn! Do you want to proceed?"),callback:function(r){return _asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,b.block(),t.next=6,a.call("promotion.deletePromotion",e);case 6:k.refetchEvents(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),b.unblock(),window.appError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,9]])})))()}}),!1}function A(e,r,t){return S.apply(this,arguments)}function S(){return(S=_asyncToGenerator(regeneratorRuntime.mark((function r(t,o,c){var u,d,p,l,f,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i(["reserve.blocking"])){r.next=2;break}return r.abrupt("return");case 2:if(r.prev=2,b.block(),!t||"new"===t){r.next=11;break}return r.next=7,a.call("reserve.getReservation",t);case 7:d=r.sent,u=d[0],r.next=14;break;case 11:u={_idowner:c._id,type:o},w&&(u._dtcheckIn=s.utc(w).toDate()),x&&(u._dtcheckOut=s.utc(x).toDate());case 14:if("blocked"!==u.type&&"maintenance"!==u.type){r.next=28;break}return i(["reserve.edit"])||(u._t_ismy=1,u.ctasks={_b_before:1,_b_after:1}),r.next=18,Promise.all([a.call("reserve.getCalendarBlock",{apid:u._idowner,excld:u._id,nolimit:1}),n._render("calendar/reserve_edit",{reserve:u})]);case 18:p=r.sent,l=p[0],f=p[1],m=e(f).modal(),window.setFullscreenModal(m),m.on("show.bs.modal",(function(){m.find("#from, #till").datepicker("setCalendarBlockUTC",l)})),m.on("frm-saved",(function(e,r){m.modal("hide"),k.refetchEvents()})),m.on("frm-cancel",(function(){m.modal("hide")})),r.next=29;break;case 28:window.pageReload(null,window._prefix+"reservation/"+u.id);case 29:r.next=34;break;case 31:r.prev=31,r.t0=r.catch(2),window.appError(r.t0);case 34:return r.prev=34,b.unblock(),r.finish(34);case 37:case"end":return r.stop()}}),r,null,[[2,31,34,37]])})))).apply(this,arguments)}function C(e,t){if(i(["reserve.delete"]))return u.confirm({title:r("Warning!"),type:u.TYPE_WARNING,message:r("This action cannot be withdrawn! Do you want to proceed?"),callback:function(r){return _asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,b.block(),t.next=6,a.call("reserve.deleteReservation",e);case 6:k.refetchEvents(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),b.unblock(),window.appError(t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,9]])})))()}}),!1}function I(e,t){if(i(["reserve.delete"]))return u.confirm({title:r("Warning!"),type:u.TYPE_WARNING,message:r("This action cannot be withdrawn! Do you want to proceed?"),callback:function(r){return _asyncToGenerator(regeneratorRuntime.mark((function n(){var o,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,b.block(),n.next=6,a.call("reserve.getReservation",e);case 6:return o=n.sent,(i=o[0])["_b_free_"+(t?"before":"after")]=1,n.next=11,a.call("reserve.saveReservation",i);case 11:k.refetchEvents(),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(2),b.unblock(),window.appError(n.t0);case 18:case"end":return n.stop()}}),n,null,[[2,14]])})))()}}),!1}function O(e){return F.apply(this,arguments)}function F(){return(F=_asyncToGenerator(regeneratorRuntime.mark((function r(i){var c,s,u,l,f,m,_,v,k,h;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,b.block(),c=p(w,x,"day"),Number.isFinite(c)&&!(c<o._i_minReserveDuration)){r.next=6;break}return window.appError(new d(d.Message.SUBCEEDS_MIN_STAY,d.Subject.SUBCEEDS_MIN_STAY,o._i_minReserveDuration)),r.abrupt("return");case 6:if(!(c>o._i_maxReserveDuration)){r.next=9;break}return window.appError(new d(d.Message.EXCEEDS_MAX_STAY,d.Subject.EXCEEDS_MAX_STAY,o._i_maxReserveDuration)),r.abrupt("return");case 9:return r.next=11,a.call("price.getPrice",i._id,w,x,{persons:1});case 11:if(s=r.sent,u=s.glr,l=[],o._b_calcByPersons||o._b_calcByPersons_derived)for(f=i._i_maxPers||1,m=1;m<=f;)_={val:m},l.push(_),m++;return v={apt_id:i._id,glr:u[0],add_fees:u[0].add_fees,filterPersons:l,persons:1},r.next=18,n._render("calendar/calendar_price_popup",v);case 18:k=r.sent,h=e(k).modal(),window.setFullscreenModal(h),(o._b_calcByPersons||o._b_calcByPersons_derived)&&h.on("rerender",function(){var r=_asyncToGenerator(regeneratorRuntime.mark((function r(o,c){var s,u,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return h.block(),r.prev=1,r.next=4,a.call("price.getPrice",i._id,w,x,{persons:c});case 4:return s=r.sent,u=s.glr,v.filterPersons=t.cloneDeep(l),v.glr=u[0],v.add_fees=u[0].add_fees,t.each(v.filterPersons,(function(e){e.val==c&&(e.selected=!0)})),r.next=12,n._render("calendar/calendar_price_popup",v);case 12:d=r.sent,h.off("change"),h.find(".modal-dialog").replaceWith(e(d).html()),r.next=20;break;case 17:r.prev=17,r.t0=r.catch(1),window.appError(r.t0);case 20:return r.prev=20,h.unblock(),r.finish(20);case 23:case"end":return r.stop()}}),r,null,[[1,17,20,23]])})));return function(e,t){return r.apply(this,arguments)}}()),r.next=27;break;case 24:r.prev=24,r.t0=r.catch(0),window.appError(r.t0);case 27:return r.prev=27,b.unblock(),r.finish(27);case 30:case"end":return r.stop()}}),r,null,[[0,24,27,30]])})))).apply(this,arguments)}function B(e){return N.apply(this,arguments)}function N(){return(N=_asyncToGenerator(regeneratorRuntime.mark((function r(c){var u,l,f,m,_,k,y,E,T,D,M,S;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=c.start,l=c.end,c.startStr,c.endStr,c.allDay,f=c.jsEvent,c.view,m=c.resource,f&&f.preventDefault(),_=t.get(m,"extendedProps.apartment",v),w=s.utc(u).hours(t.get(_,"arrival._i_defCheckIn",o.arrival._i_defCheckIn)).toDate(),x=s.utc(l).hours(t.get(_,"departure._i_defCheckOut",o.departure._i_defCheckOut)-24).toDate(),!(p(w,x,"day")+1<1)){r.next=8;break}return r.abrupt("return");case 8:if(k=h.isSameOrBefore(w),y=!1,"promotion"!==(E=t.clone(t.get(m,"extendedProps.r_type",{booking:!0,price:!0,blocking:!0,promotion:!(_._id&&(_._idPriceGroup||_._idcloneof)),restriction:!(_._id&&(_._idPriceGroup||_._idcloneof))})))){r.next=24;break}if(k){r.next=14;break}return r.abrupt("return");case 14:if(o.promotionModel._b_simple||o.promotionModel._b_advanced){r.next=16;break}return r.abrupt("return");case 16:if(_){r.next=18;break}return r.abrupt("return",G(_));case 18:if(!o.promotionModel._b_advanced||o.promotionModel._b_simple){r.next=22;break}return r.next=21,g(_);case 21:return r.abrupt("return",P("new",_));case 22:if(o.promotionModel._b_advanced||!o.promotionModel._b_simple){r.next=24;break}return r.abrupt("return",G(_));case 24:if("restriction"!==E){r.next=28;break}if(k){r.next=27;break}return r.abrupt("return");case 27:return r.abrupt("return",J(_));case 28:if("rate"!==E){r.next=32;break}if(k){r.next=31;break}return r.abrupt("return");case 31:return r.abrupt("return",R(_));case 32:if(!E.booking||!k&&!i(["reserve.date.edit.to.past"])){r.next=38;break}return r.next=35,a.call("helpers.applyApartmentFilterEx",{from:w,to:x},{_id:_._id},{});case 35:T=r.sent,D=T.count,E.booking=!!D;case 38:if(E.blocking&&(E.blocking=k||i(["reserve.date.edit.to.past"])),!E.promotion&&"promotion"!==E){r.next=54;break}if(E.promotion=k,!k||!o.promotionModel._b_advanced){r.next=54;break}return r.prev=42,r.next=45,g(_);case 45:r.next=54;break;case 47:if(r.prev=47,r.t0=r.catch(42),!r.t0||"ApiError"!==r.t0.name){r.next=53;break}y=!0,r.next=54;break;case 53:throw r.t0;case 54:if("promotion"!==E||!y){r.next=56;break}return r.abrupt("return",G(_));case 56:return E.restriction&&(E.restriction=k),E.rate&&(E.rate=k),r.prev=58,b.block(),r.next=62,n._render("calendar/range_select",{_dtfrom:w,_dtto:x,haspromotion:y,r_type:"promotion"===E?{promotion:!0}:E,apt:_});case 62:M=r.sent,S=e(M).modal(),window.setFullscreenModal(S),_._i_maxPers||S.on("click",".makeBooking",(function(){return window.appError(new d("The lsiting setup is incomplete. It is missing at least one bed to be available for bookings.")),!1})),i(["apartment.price.view"])&&S.on("click",".calculatePrice",(function(){return O(_),!1})),i(["promotion.edit"])&&(S.on("click",".createPromotion",(function(){return P("new",_),!1})),S.on("click",".createPromotionSimple",(function(){return G(_),!1}))),i(["reserve.blocking"])&&S.on("click",".editReservation",(function(){return A(e(this).data("_id"),e(this).data("type"),_),!1})),i(["calendar.block.check-in-out-date.add"])&&S.on("click",".createRestriction",(function(){return J(_),!1})),r.next=75;break;case 72:r.prev=72,r.t1=r.catch(58),window.appError(r.t1);case 75:return r.prev=75,b.unblock(),r.finish(75);case 78:case"end":return r.stop()}}),r,null,[[42,47],[58,72,75,78]])})))).apply(this,arguments)}function Y(){w=!1,x=!1}function $(e){return j.apply(this,arguments)}function j(){return(j=_asyncToGenerator(regeneratorRuntime.mark((function r(t){var n,a,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.event,a=t.el,o=t.jsEvent,t.view,o&&o.preventDefault(),"background"!==n.rendering){r.next=4;break}return r.abrupt("return");case 4:if(n.id){r.next=6;break}return r.abrupt("return");case 6:if(c=e(a),r.prev=7,b.block(),!c.hasClass("event-promotion")){r.next=16;break}if(i(["promotion.view"])){r.next=12;break}return r.abrupt("return");case 12:return r.next=14,W(n);case 14:r.next=24;break;case 16:if(!c.hasClass("timegap")){r.next=22;break}return r.next=19,U(n);case 19:return r.abrupt("return");case 22:return r.next=24,q(n);case 24:r.next=29;break;case 26:r.prev=26,r.t0=r.catch(7),window.appError(r.t0);case 29:return r.prev=29,b.unblock(),r.finish(29);case 32:case"end":return r.stop()}}),r,null,[[7,26,29,32]])})))).apply(this,arguments)}function W(e){return L.apply(this,arguments)}function L(){return(L=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.extendedProps.apartment,e.next=3,a.call("promotion.getPromotion",t.id);case 3:return i=e.sent,e.next=6,n._render("calendar/calendar_promotion_rover",i);case 6:c=e.sent,u.show({title:r("Promotion"),type:u.TYPE_DEFAULT,message:c,size:u.SIZE_SMALL,onshown:function(e){window.setFullscreenModal(e.$modal),e.$modal.find(".editPromo").click((function(){P(i._id,o),e.close()})),e.$modal.find(".deletePromo").click((function(){M(i._id),e.close()}))}});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return X.apply(this,arguments)}function X(){return(X=_asyncToGenerator(regeneratorRuntime.mark((function e(r){var t,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.extendedProps.reserve,e.next=3,a.call("reserve.getReserveForCalendar",r.extendedProps.hasGroup?r.extendedProps.hasGroup:r.id);case 3:return o=e.sent,e.next=6,n._render("calendar/calendar_event_title",o);case 6:return i=e.sent,e.next=9,n._render("calendar/calendar_blocking_rover",Object.assign({_t_dtfrom:t._dtcheckIn,_t_dtto:t._dtcheckOut,title:r.title},o));case 9:c=e.sent,u.show({title:i,type:u.TYPE_DEFAULT,size:u.SIZE_SMALL,message:c,onshown:function(e){window.setFullscreenModal(e.$modal),e.$modal.find(".deleteBetweenBlocking").click((function(){I(o._id,s.utc(t._dtcheckIn).isBefore(o._dtcheckIn)),e.close()}))}});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return z.apply(this,arguments)}function z(){return(z=_asyncToGenerator(regeneratorRuntime.mark((function e(r){var t,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.extendedProps.apartment,e.next=3,a.call("reserve.getReserveForCalendar",r.extendedProps.hasGroup?r.extendedProps.hasGroup:r.id);case 3:return o=e.sent,e.next=6,a.call("reserve.getReserveDepositInfo",o);case 6:return o.depositInfo=e.sent,e.next=9,n._render("calendar/calendar_event_rover",o);case 9:return i=e.sent,e.next=12,n._render("calendar/calendar_event_title",o);case 12:c=e.sent,u.show({title:c,type:u.TYPE_DEFAULT,message:i,onshown:function(e){window.setFullscreenModal(e.$modal),e.$modal.find(".editReservation").click((function(){A(o._id,o.type,t),e.close()})),e.$modal.find(".deleteReservation").click((function(){C(o._id),e.close()}))}});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){var r=e.event;e.el,e.jsEvent,e.view;"background"!==r.rendering&&r.extendedProps.hasGroup&&b.find("[data-hasGroup="+r.extendedProps.hasGroup+"]").css("border","2px solid red")}function H(e){var r=e.event;e.el,e.jsEvent,e.view;"background"!==r.rendering&&r.extendedProps.hasGroup&&b.find("[data-hasGroup="+r.extendedProps.hasGroup+"]").css("border","")}function J(e){return K.apply(this,arguments)}function K(){return(K=_asyncToGenerator(regeneratorRuntime.mark((function r(t){var o,i,c,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,b.block(),r.next=4,a.call("restriction.getRestrictionsDays",{_idapartment:t._id,_idregion:t._idregion,_dtfrom:w,_dtto:x});case 4:return o=r.sent,i=p(w,x,"day")+1,r.next=8,n._render("calendar/restrictions",{_dtfrom:w,_dtto:x,_idapartment:t._id,_idregion:t._idregion,restriction:{Arrival:{d:i===o.Arrival.length,e:!o.Arrival.length},Departure:{d:i===o.Departure.length,e:!o.Departure.length}},week:[1,2,3,4,5,6,0].map((function(e){return{day:e,text:s.utc().day(e).format("ddd").toUpperCase()}}))});case 8:c=r.sent,(u=e(c).modal()).on("frm-saved",(function(){k.refetchEvents()})),window.setFullscreenModal(u),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(0),window.appError(r.t0);case 17:return r.prev=17,b.unblock(),r.finish(17);case 20:case"end":return r.stop()}}),r,null,[[0,14,17,20]])})))).apply(this,arguments)}function Q(e){return V.apply(this,arguments)}function V(){return(V=_asyncToGenerator(regeneratorRuntime.mark((function t(o){var i,s,d,p,l,f,m,_,v,h,w,x,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.event,o.oldEvent,o.delta,s=o.revert,o.jsEvent,o.view,d=o.oldResource,p=o.newResource){t.next=3;break}return t.abrupt("return",s());case 3:if(!i.extendedProps.hasGroup){t.next=8;break}if(l=d.extendedProps.hasMaster||d.extendedProps.apartment._id,f=p.extendedProps.hasMaster||p.extendedProps.apartment._id,l===f){t.next=8;break}return t.abrupt("return",s());case 8:return t.prev=8,b.block(),t.next=12,a.call("reserve.findReservationsEx",{_id:i.id},{fields:{type:1,id:1,_dtcheckIn:1,_dtcheckOut:1,resolveIn:1,_idowner:1,_idmasterRes:1}});case 12:if(m=t.sent,_=m[0]){t.next=16;break}return t.abrupt("return",s());case 16:if(!_._idmasterRes){t.next=23;break}return t.next=19,a.call("reserve.findReservationsEx",{_id:_._idmasterRes},{fields:{id:1,type:1}});case 19:v=t.sent,h=v[0],_.type=h.type,_.id=h.id;case 23:if("reserved"===_.type||"booked"===_.type){t.next=25;break}return t.abrupt("return",s());case 25:return t.next=27,n._render("reservation/switch_alert",_);case 27:w=t.sent,x=e(w),g=u.confirm({title:r("Are you sure to switch apartment from %s to %s?").replace("%s",d.title).replace("%s",p.title),type:u.TYPE_WARNING,message:x,callback:function(e){return _asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",s());case 2:if(t.prev=2,g.$modal.block(),!_._idmasterRes){t.next=9;break}return t.next=7,a.call("reserve.switchGroupApartment",{res_id:i.id,apt_id:p.id});case 7:t.next=11;break;case 9:return t.next=11,a.call("reserve.switchApartment",{res_id:i.id,apt_id:p.id,notCalculate:_._idmasterRes||x.find("#notCalculate").is(":checked")});case 11:k.refetchEvents(),g.close(),_.resolveIn&&u.confirm({title:r("Warning!"),type:u.TYPE_WARNING,message:r("Switching apartment was made after check-in, do you want create cleaning task for previous apartment?"),callback:function(e){e&&setTimeout(c,1e3,{_t_apartment:{_id:_._idowner},job:"clean"})}}),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),s(),window.appError(t.t0);case 20:return t.prev=20,g.$modal.unblock(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[2,16,20,23]])})))()},onshown:function(e){window.setFullscreenModal(e.$modal)}}),t.next=36;break;case 32:t.prev=32,t.t0=t.catch(8),s(),window.appError(t.t0);case 36:return t.prev=36,b.unblock(),t.finish(36);case 39:case"end":return t.stop()}}),t,null,[[8,32,36,39]])})))).apply(this,arguments)}k.batchRendering((function(){k.setOption("unselectAuto",!1),k.setOption("select",B),k.setOption("unselect",Y),k.setOption("eventClick",$),k.setOption("eventMouseEnter",Z),k.setOption("eventMouseLeave",H),k.setOption("eventDrop",Q),k.setOption("longPressDelay",300),k.setOption("buttonText",{today:r("today"),month:r("month"),week:r("week"),day:r("day"),year:r("year")}),k.setOption("eventLimitText",r("more"))})),b.data("calendar",k)}}));