function asyncGeneratorStep(n,r,e,t,o,c,a){try{var i=n[c](a),u=i.value}catch(n){return void e(n)}i.done?r(u):Promise.resolve(u).then(t,o)}function _asyncToGenerator(n){return function(){var r=this,e=arguments;return new Promise((function(t,o){var c=n.apply(r,e);function a(n){asyncGeneratorStep(c,t,o,a,i,"next",n)}function i(n){asyncGeneratorStep(c,t,o,a,i,"throw",n)}a(void 0)}))}}define(["jquery","socket.io","api","checkperm"],(function(n,r,e,t){return function(){return n((function(){if(t(["smm.view"])){var o=n(window),c=n("#smmCount"),a=r("/smm",{forceNew:!0,transports:["websocket"]});a.on("error",(function(n){window.appError(n)})),a.on("disconnected",(function(){})),a.on("changed",(function(n){o.trigger("smm",n),i().catch(window.appError)})),i().catch(window.appError)}function i(){return u.apply(this,arguments)}function u(){return(u=_asyncToGenerator(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.call("smm.getCount",{query:{_b_unread:1}});case 2:(r=n.sent)?c.text(r).show():c.hide();case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}}))}}));