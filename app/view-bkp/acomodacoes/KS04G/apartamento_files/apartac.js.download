function asyncGeneratorStep(e,n,t,r,a,i,o){try{var d=e[i](o),s=d.value}catch(e){return void t(e)}d.done?n(s):Promise.resolve(s).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){asyncGeneratorStep(i,r,a,o,d,"next",e)}function d(e){asyncGeneratorStep(i,r,a,o,d,"throw",e)}o(void 0)}))}}define(["jquery","api","lodash","pickTranslate","autocomplete/autoselector","api!helpers.getUserAllowsAptIDS"],(function(e,n,t,r,a,i){"use strict";function o(e){i&&(e.$and=e.$and||[],e.$and.push({_id:{$in:i}}))}return a({key:"apartmentid",template:"apartment",getter:function(e){var a=this;return _asyncToGenerator(regeneratorRuntime.mark((function i(){var d,s,u,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return d=(void 0===e?{}:e).queryFilter,o(s=void 0===d?{active:{$in:["yes","hidden"]}}:d),i.next=4,n.cache("apartment.getSimpleApartments",s,{id:1,avatar:1,_adr:1,_idowner:1,_idbuilding:1});case 4:return u=i.sent,a.data("autoselector.items",u),c=t(u).groupBy((function(e){var n=e._adr,a=void 0===n?{}:n;return[r(t.get(a,"_t_country._msname")),a.state,a.city,a.region].filter(Boolean).join(", ")})).map((function(e,n){return{items:e,code:n}})).value(),i.abrupt("return",{groups:c});case 8:case"end":return i.stop()}}),i)})))()},postrender:function(n){var t=void 0===n?{}:n,r=t.$landlord,a=t.$building;if(r&&r.length||a&&a.length){var i=this,o=function(){if(i.find("option[data-_idbuilding], option[data-_idowner]").prop("disabled",!1),a&&a.length&&a.val().length){var n=a.val();n=Array.isArray(n)?n:[n],i.find("option[data-_idbuilding]").each((function(){var t=e(this);n.includes(t.data("_idbuilding"))||t.prop("disabled",!0)}))}if(r&&r.length&&r.val().length){var t=r.val();t=Array.isArray(t)?t:[t],i.find("option[data-_idowner]").each((function(){var n=e(this);t.includes(n.data("_idowner"))||n.prop("disabled",!0)}))}i.prop("disabled",0===i.find("option[data-_idbuilding]").not(":disabled").length),i.selectpicker("refresh")};a&&a.length&&a.on("changed.bs.select",o),r&&r.length&&r.on("changed.bs.select",o),o()}}})}));