function asyncGeneratorStep(e,n,t,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){asyncGeneratorStep(o,r,a,i,c,"next",e)}function c(e){asyncGeneratorStep(o,r,a,i,c,"throw",e)}i(void 0)}))}}define(["jquery","i18n","clitpl","api","lodash","checkperm","admin/perfect-scrollbar","bootstrap","jquery-addons","jquery-block"],(function(e,n,t,r,a,o,i){"use strict";o(["task.list.edit","task.list.edit.me"])&&e(document.body).on("click","#topbar #new_task, #maincontent #new_task",(function(){return requirejs(["admin/task_create"],(function(e){e({})}),window.appError),!1}));var c=e("#header"),u=e("#topbar"),l=e("#mainblock");if(e(window).width()>768){var s=document.getElementById("leftmenu"),d=new i(s,{swipeEasing:!1,wheelPropagation:!0});e(window).resize((function(){return d.update()})),l.find("main > .context").on("click touchstart",(function(){window.requestAnimationFrame((function(){s.scrollTop=0,c.find(".dropdown-menu.show").removeClass("show"),c.find(".dropdown.open").removeClass("open")}))}))}function f(n){n.on("change keypress",(function(t,r){var a=this;"internal"!==r&&requirejs(["api!price.getLastExchangeRate"],(function(t){var r=e(a);setTimeout((function(){var a=parseFloat(r.val());n.not(r).each((function(){null==!Number.isFinite(a)?e(this).val(""):e(this).val((a*t[r.attr("name")+e(this).attr("name")]).pokLocaleString(window._user.language,{minimumFractionDigits:2,maximumFractionDigits:2}))}))}),1)}))}))}c.find(".dropdown-menu a.dropdown-toggle").on("click",(function(n){return e(this).next(".dropdown-menu").toggleClass("show"),!1})),c.find(".mainmenubulet.dropdown").click((function(){var n=e(this).find("a:not(.dropdown-toggle)");if(1===n.length&&"#"!==n.attr("href"))return window.pageReload(null,n.attr("href")),!1})),f(u.find(".calculator input")),f(c.find(".calculator input"));var p=c.find(".mainmenubulet");function h(){return m.apply(this,arguments)}function m(){return(m=_asyncToGenerator(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e(this),n.prev=1,n.next=4,r.call("core.updateMe",{language:t.data("locale")});case 4:window.location.reload(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),window.appError(n.t0);case 10:case"end":return n.stop()}}),n,this,[[1,7]])})))).apply(this,arguments)}function w(){return v.apply(this,arguments)}function v(){return(v=_asyncToGenerator(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e(this),n.prev=1,n.next=4,r.call("core.updateMe",{currency:t.data("currency")});case 4:window.location.reload(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),window.appError(n.t0);case 10:case"end":return n.stop()}}),n,this,[[1,7]])})))).apply(this,arguments)}p.filter(".dropdown").each((function n(){var t=e(this);t.is(".mainmenubulet")?t.find(".dropdown-menu").each(n):t.is(".dropdown-menu")&&t.find(".dropdown-submenu").each(n);0===t.find("li:not(.divider)").length&&t.remove();t.find("> li").each((function(){var n=e(this);n.is(".divider")&&n.next("li").is(".divider")&&n.remove()})),function e(){t.find("> li:first, > li:last").filter(".divider").remove().length&&e()}()})),p.filter(".fade").addClass("in"),u.find(".locales a").click(h),c.find(".locales a").click(h),u.find(".currencies a").click(w),c.find(".currencies a").click(w),c.find(".navbar-toggle").click((function(){c.find(".navbar-toggle .fa").toggleClass("fa-bars").toggleClass("fa-times")})),e(document).on("pageReload.start",(function(){c.find(".sidebar-navbar-collapse").hasClass("in")&&c.find(".navbar-toggle").click()})),c.find(".multisearch").click((function(n){return 0===e(n.target).closest(".multisearch form").length&&e(this).toggleClass("open"),!1})),u.find("#onthefly").on("click",(function(){return e(this).remove(),new window.MutationObserver(a.debounce((function(){l.find('[value*="<span data-orighex"]').toArray().forEach((function(n){n.value=e(n.value).text()})),l.find('[placeholder*="<span data-orighex"]').toArray().forEach((function(n){n.placeholder=e(n.placeholder).text()})),setTimeout((function(){l.find("[data-orighex]").off("click").toArray().forEach((function(n){var a=e(n);a.click(function(){var n=_asyncToGenerator(regeneratorRuntime.mark((function n(o){var i,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.ctrlKey){n.next=2;break}return n.abrupt("return");case 2:return o.preventDefault(),o.stopPropagation(),l.block(),n.next=7,r.call("localization.getLocalizationByHex",{hex:a.data("orighex").trim(),domain:"admin"});case 7:if(i=n.sent){n.next=10;break}return n.abrupt("return");case 10:return i.orig=i.orig.replace(t.re_i18ncolorify,""),n.next=13,t._render("localization/localization_edit",i);case 13:c=n.sent,(u=e(c).modal()).on("savelocale",function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.block(),e.prev=1,e.next=4,r.call("localization.saveLocalization",t);case 4:a.text(t._msvalue[window._user.language]),u.modal("hide"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),u.unblock(),window.appError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(n,t){return e.apply(this,arguments)}}()),l.unblock();case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}),100)}),500)).observe(l[0],{childList:!0,subtree:!0}),window.__localization_on_the_fly=1,e.ajaxSetup({headers:{"pok-localization-on-the-fly":!0}}),window.pageReload(),!1})),o(["mailchimp.subscribers.export"])&&c.on("click",".btn-mailchimp-export",function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),l.block(),t.prev=2,t.next=5,e.ajax({url:r.target.href,method:"POST"});case 5:window.appInfo(n("Your request accepted. Wait email.")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),window.appError(t.t0);case 11:return t.prev=11,l.unblock(),t.finish(11);case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,null,[[2,8,11,14]])})));return function(e){return t.apply(this,arguments)}}())}));