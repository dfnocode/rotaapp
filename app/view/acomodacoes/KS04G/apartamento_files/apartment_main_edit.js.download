function asyncGeneratorStep(e,n,t,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){asyncGeneratorStep(i,r,a,o,c,"next",e)}function c(e){asyncGeneratorStep(i,r,a,o,c,"throw",e)}o(void 0)}))}}define(["jquery","i18n","api","lodash","admin/translateac","checkperm","beforeUnload","jquery-block","jquery-addons"],(function(e,n,t,r,a,i,o){return function(c){var u=c.apartment._id;return e((function(){var c=e("#maincontent"),s=c.find("#save-main-form");s.validate(),a(s.find("[name='proptypes']"),"listingTypes"),s.find("[name='subtypes']").data("filter",(function(e){return!(r.get(e,"metadata._b_bathroom")&&!r.get(e,"metadata._b_bedroom")||r.get(e,"metadata._b_livingroom")||0===r.get(e,"metadata.bookingcom._i_code"))})),a(s.find("[name='subtypes']"),"roomTypes"),s.find("[name='types']").on("changed.bs.select",(function(){var e=s.find("[name='types']:not(:checked)").toArray().map((function(e){return"."+e.value})).join(","),n=s.find("[name='types']:checked").toArray().map((function(e){return"."+e.value})).join(",");e&&s.find(e).hide(),n&&s.find(n).show()})).change(),s.find("[name='types']").on("change",(function(n){"regular"==e(n.currentTarget).val()&&s.find(".row-regular-only").toggleClass("hidden",!e(n.currentTarget).prop("checked"))})),s.find("#building-checkbox").change((function(){s.find("#building").toggle(e(this).is(":checked")).prop("required",e(this).is(":checked"))})),s.find("#btn-cancel").click((function(e){return e.preventDefault(),s.trigger("frm-cancel"),!1})),i(["apartment.main.edit"])&&(s.submit(function(){var r=_asyncToGenerator(regeneratorRuntime.mark((function r(a){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a.preventDefault(),s.find(".form-group").removeClass("error"),(i={_id:u,_idpropertyType:s.find("[name='proptypes']").val(),_idtype:s.find("[name='subtypes']").val(),types:{}})._s_propType=s.find("[name='prop-type']:checked").val(),s.find("[name='types']:checked").each((function(){var n=e(this).val();"regular"===n?i.types._b_main=1:"forsale"===n?i.types._b_sale=1:"rental"===n&&(i.types._b_rental=1)})),i.types._b_main&&(i.regNum=s.find("#regNum").val()),c.block(),r.prev=7,r.next=10,t.call("apartment.saveApartment",i);case 10:if(window.appInfo(n("Saved successfully")),s.find(":submit").button("reset").hide(),c.find(".unsaved").length){r.next=14;break}return r.abrupt("return",window.pageReload());case 14:r.next=19;break;case 16:r.prev=16,r.t0=r.catch(7),window.appError(r.t0);case 19:return r.prev=19,c.unblock(),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[7,16,19,22]])})));return function(e){return r.apply(this,arguments)}}()),o(s,s.find(":submit")))}))}}));