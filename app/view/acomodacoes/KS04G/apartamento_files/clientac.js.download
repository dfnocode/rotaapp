function _createForOfIteratorHelperLoose(e,a){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||a&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function _unsupportedIterableToArray(e,a){if(e){if("string"==typeof e)return _arrayLikeToArray(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,a):void 0}}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=new Array(a);t<a;t++)n[t]=e[t];return n}define(["api","safe","bootstrap-typeahead"],(function(e,a){var t=Object.create(null);return function(n,r){function i(e){return n.attr("data-clientid",t[e]._id),n.data("clientid",t[e]._id),r&&(t[e].emails&&t[e].emails[0]&&r.find("#email").val(t[e].emails[0].adr),t[e].phones&&t[e].phones[0]&&r.find("#phone").val(t[e].phones[0].num),t[e]._id&&(r.find("#email").prop("disabled",!0),r.find("#phone").prop("disabled",!0))),e}n.attr("autocomplete","off").attr("data-validateattr","clientid").data("validateattr","clientid"),n.data("clientid")&&e.cache("contact.getContact",{_id:n.data("clientid")},a.sure(window.appError,(function(e){e?((e.emails&&e.emails.length?e.emails[0].adr:"")&&(e.name+=" ("+e.emails[0].adr+")"),t[e.name]=e,n.val(e.name),i(e.name)):(n.removeAttr("data-clientid"),n.data("clientid",null))}))),n.typeahead({minLength:2,items:100,source:function(n,r){!function(n,r){e.cache("contact.clientacExt",n.replace(/\(.*\)/,"").trim(),a.sure_result(r,(function(e){return e.map((function(e){return(e.emails&&e.emails.length?e.emails[0].adr:"")&&(e.name+=" ("+e.emails[0].adr+")"),t[e.name]=e,{name:e.name}}))})))}(n,a.sure(window.appError,(function(e){for(var a,t=_createForOfIteratorHelperLoose(e);!(a=t()).done;){var o=a.value;n===o.name&&i(o.name)}r(e)})))},updater:function(e){return{name:i(e.name)}}}),n.on("click",(function(){n.trigger("keyup")})),n.on("change",(function(){""==n.val()&&(n.data("clientid",""),n.attr("data-clientid",""),r&&(r.find("#email").prop("disabled",!1).val(""),r.find("#phone").prop("disabled",!1).val("")))})),n.on("keypress",(function(){n.data("clientid")&&(n.attr("data-clientid",""),n.data("clientid",""),r&&(r.find("#email").prop("disabled",!1).val(""),r.find("#phone").prop("disabled",!1).val("")))}))}}));